# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Contatos Screen:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - cpm_Tela_Geral_3:
          Control: CanvasComponent
          ComponentName: cpm_Tela_Geral
          Properties:
            Height: =1136
            ListaDasTelas: =colTelas
      - Container2_3:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =Parent.Height - 70
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Self.X * 2
            X: =10
          Children:
            - Container6_10:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =60
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - Label1_18:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Semibold
                        Height: =60
                        Size: =16
                        Text: ="CONTATOS NA OBRA"
                        Width: =Parent.Width - Self.X
                        Wrap: =false
            - Container9_3:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =RGBA(45, 65, 93, 1)
                  BorderThickness: =2
                  DropShadow: =DropShadow.Semilight
                  Fill: =RGBA(45, 65, 93, 1)
                  Height: =Parent.Height - Self.Y * 2
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Parent.Width - Self.X * 2
                  Y: =10
                Children:
                  - Gallery3_6:
                      Control: Gallery@2.15.0
                      Variant: VariableHeight
                      Properties:
                        BorderColor: =
                        Height: =Parent.Height - Self.Y
                        Items: |-
                          =SortByColumns(
                              Filter(
                                  db_cont_contrato,
                                  IsBlank(TextInput1_18.Selected.n_contrato) || n_contrato = TextInput1_18.Selected.n_contrato),
                              "n_contrato",
                              SortOrder.Ascending)
                        ShowScrollbar: =false
                        TemplateSize: =120
                        Width: =Parent.Width
                        Y: =90
                      Children:
                        - Gallery1_3:
                            Control: Gallery@2.15.0
                            Variant: VariableHeight
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Height: |-
                                =If(varQuantidadeItens = 0,
                                Self.AllItemsCount * 30 * 2 + (35 * varQuantidadeItens),
                                Self.AllItemsCount * 35 * 2 + (35 * varQuantidadeItens + 20))
                              Items: |-
                                =SortByColumns(
                                    Filter(db_cont_pessoas_obra, id_contrato = ThisItem.n_contrato && status = "Ativo"),
                                    "id_cargo_responsabilidade",
                                    SortOrder.Ascending)
                              ShowScrollbar: =false
                              TemplatePadding: =10
                              TemplateSize: =55
                              Visible: =varExpandido = ThisItem.n_contrato
                              Width: =Parent.TemplateWidth-Self.X
                              X: =1
                              Y: =120
                            Children:
                              - Container7_4:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    DropShadow: =DropShadow.Semilight
                                    Fill: =RGBA(255, 255, 255, 1)
                                    Height: =Gallery1_3.TemplateHeight
                                    RadiusBottomLeft: =10
                                    RadiusBottomRight: =10
                                    RadiusTopLeft: =10
                                    RadiusTopRight: =10
                                    Width: =Parent.Width - 10
                                  Children:
                                    - htmltxt_historico_2:
                                        Control: HtmlViewer@2.1.0
                                        Properties:
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          Fill: =RGBA(214, 223, 238, 1)
                                          Font: =Font.'Open Sans'
                                          Height: =Gallery1_3.TemplateHeight
                                          HtmlText: |
                                            ="<div style='width:100%; font-family:Arial; font-size:15px; color:#2d415d; padding:5px; border-bottom:1px solid white;'>

                                              <!-- Nome -->
                                              <div style='font-size:15px; font-weight:bold; margin-bottom:2px;'>
                                                " & Concatenate(LookUp(db_cont_pessoas_obra_cargo, id_cargo_responsabilidade = ThisItem.id_cargo_responsabilidade, cargo_responsabilidade), " - ", ThisItem.nome) & "
                                              </div>

                                            <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                              <div style='font-size:14px; display:flex; gap:5px; margin-top:5px; flex-wrap:wrap; margin-bottom:2px'>
                                                <div style='width:170px'><strong>Telefone:</strong> " & ThisItem.telefone & "</div>
                                              </div>
                                            </div>"
                                          PaddingBottom: =0
                                          PaddingLeft: =0
                                          PaddingRight: =0
                                          PaddingTop: =0
                                          Width: =Parent.Width
                                    - Image4:
                                        Control: Image@2.2.3
                                        Properties:
                                          BorderColor: =RGBA(0, 18, 107, 1)
                                          Height: =40
                                          Image: =whatsapp
                                          OnSelect: |-
                                            =Launch(
                                                "whatsapp://send?phone=" &
                                                // Limpa o número de telefone removendo + ( ) e -
                                                Substitute(
                                                    Substitute(
                                                        Substitute(
                                                            Substitute(
                                                                Substitute(ThisItem.telefone, " ", ""), // Remove espaços
                                                            "(", ""), // Remove (
                                                        ")", ""), // Remove )
                                                    "-", ""), // Remove -
                                                "+", "") & // Remove + (Importante!)
                                                "&text=" & EncodeUrl("Olá " & ThisItem.nome & "; tudo bem? Estou entrando em contato sobre o seu pedido ID: " & ThisItem.id_cargo_responsabilidade & ".")
                                            )
                                          Width: =90
                                          X: =Parent.Width - Self.Width
                                          Y: =5
                                    - Image6:
                                        Control: Image@2.2.3
                                        Properties:
                                          BorderColor: =RGBA(0, 18, 107, 1)
                                          Height: =40
                                          Image: =call_16799567
                                          OnSelect: |-
                                            =Launch(
                                                "tel:" &
                                                Substitute(
                                                    Substitute(
                                                        Substitute(
                                                            Substitute(ThisItem.telefone, " ", ""), // ThisItem.Telefone refere-se à coluna 'Telefone' do item atual na galeria
                                                        "(", ""),
                                                    ")", ""),
                                                "-", "")
                                            )
                                          Width: =90
                                          X: =460
                                          Y: =5
                        - Container34_6:
                            Control: GroupContainer@1.3.0
                            Variant: ManualLayout
                            Properties:
                              DropShadow: =DropShadow.Semilight
                              Height: =Parent.TemplateHeight
                              PaddingLeft: =20
                              PaddingRight: =20
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.Width - 10
                            Children:
                              - HtmlText1_4:
                                  Control: HtmlViewer@2.1.0
                                  Properties:
                                    Fill: =RGBA(255, 255, 255, 1)
                                    Font: =Font.'Open Sans'
                                    Height: =Parent.Height
                                    HtmlText: |
                                      ="<div style='width:100%; font-family:Arial; font-size:15px; color:#2d415d; padding:5px; border-bottom:1px solid white;'>

                                        <!-- Nome -->
                                        <div style='font-size:18px; font-weight:bold; margin-bottom:2px;'>
                                          " & Concatenate(ThisItem.n_contrato, " - ", ThisItem.objeto_reduzido) & "
                                        </div>

                                      <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                        <div style='font-size:14px; display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; margin-bottom:2px'>
                                          <div style='width:600px'><strong>Contratada:</strong> " & ThisItem.contratada & "</div>
                                        </div>
                                      <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                        <div style='font-size:14px; display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; margin-bottom:2px'>
                                          <div style='width:170px'><strong>Status:</strong> " & ThisItem.status_contrato.Value & "</div>
                                        </div>
                                      </div>"
                                    Width: =Parent.Width
                              - icoSeta_5:
                                  Control: Classic/Icon@2.5.0
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    DisabledBorderColor: =
                                    DisabledColor: =RGBA(202, 202, 202, 1)
                                    DisabledFill: =RGBA(0, 0, 0, 0)
                                    DisplayMode: =If(!IsEmpty(Filter(db_cont_empreendimento, n_contrato = ThisItem.n_contrato)), DisplayMode.Edit, DisplayMode.Disabled)
                                    FocusedBorderThickness: =0
                                    Height: |
                                      =50
                                    HoverColor: =ColorFade(Self.Color, 10%)
                                    HoverFill: =
                                    Icon: =If(varExpandido = ThisItem.n_contrato, Icon.ChevronDown, Icon.ChevronRight)
                                    OnSelect: |-
                                      =Set(varVisualizarEdicaoOrcamento, false);
                                      Set(varPopupConfirmacaoExclusao,false);
                                      Set(varPopupConfirmacaoAcao,false);
                                      UpdateContext({varExpandido: If(varExpandido = ThisItem.n_contrato, Blank(), ThisItem.n_contrato)});
                                      Set(varQuantidadeItens, 0);
                                      UpdateContext({varHistoricoExpandido: Blank()});

                                      Set(teste, ThisItem.n_contrato);

                                      If(Self.Icon = Icon.ChevronRight, 
                                          Set(varBordaOrcamento, true), Set(varBordaOrcamento, false))
                                    PaddingBottom: =10
                                    PaddingRight: =Self.Width-Self.Height
                                    PaddingTop: =10
                                    Width: =55
                                    X: '=Parent.Width - Self.Width '
                                    Y: =70
                  - Container10_4:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        BorderColor: =RGBA(45, 65, 93, 1)
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(45, 65, 93, 1)
                        Height: =70
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        PaddingLeft: =5
                        PaddingRight: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width
                        Y: =10
                      Children:
                        - Container5_12:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(255, 255, 255, 1)
                              Height: =80
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: =0
                              PaddingBottom: =5
                              PaddingLeft: =5
                              PaddingRight: =5
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =260
                            Children:
                              - Label1_42:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Color: =RGBA(45, 65, 93, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Semibold
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =13
                                    Text: |-
                                      ="📓 CONTRATO "
                                    Width: =100
                              - TextInput1_18:
                                  Control: Classic/ComboBox@2.4.0
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(45, 65, 93, 1)
                                    ChevronBackground: =RGBA(45, 65, 93, 1)
                                    ChevronDisabledBackground: =RGBA(255, 255, 255, 1)
                                    ChevronFill: =RGBA(255, 255, 255, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                    ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                    Color: =RGBA(255, 255, 255, 1)
                                    DisabledBorderColor: =RGBA(255, 255, 255, 1)
                                    DisabledColor: =RGBA(255, 255, 255, 1)
                                    DisplayFields: =["objeto_reduzido"]
                                    Fill: =RGBA(45, 65, 93, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =RGBA(45, 65, 93, 1)
                                    InputTextPlaceholder: =
                                    Items: '=ShowColumns(db_cont_contrato, objeto_reduzido, n_contrato) '
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnChange: =
                                    OnSelect: =
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 18, 107, 1)
                                    SearchFields: =["n_contrato"]
                                    SelectMultiple: =false
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(45, 65, 93, 1)
                                    Size: =12
                                    Width: =Parent.Width
                  - Container16_1:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderColor: =RGBA(45, 65, 93, 1)
                        BorderThickness: =4
                        DropShadow: =DropShadow.Semilight
                        Fill: =RGBA(237, 237, 237, 0.9)
                        Height: =Parent.Height
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Visible: =varPopupNovaFiscalização
                        Width: =Parent.Width
                      Children:
                        - Container17_1:
                            Control: GroupContainer@1.3.0
                            Variant: ManualLayout
                            Properties:
                              DropShadow: =DropShadow.Semilight
                              Fill: =RGBA(255, 255, 255, 1)
                              Height: =600
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.Width - Self.X * 2
                              X: =10
                              Y: =150
                            Children:
                              - Container6_11:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    Fill: =RGBA(45, 65, 93, 1)
                                    Height: =500
                                    RadiusBottomLeft: =10
                                    RadiusBottomRight: =10
                                    RadiusTopLeft: =10
                                    RadiusTopRight: =10
                                    Width: =Parent.Width - Self.X * 2
                                    X: =10
                                    Y: =70
                                  Children:
                                    - Container5_16:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Fill: =RGBA(255, 255, 255, 1)
                                          Height: =80
                                          LayoutDirection: =LayoutDirection.Vertical
                                          PaddingBottom: =5
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          RadiusBottomLeft: =10
                                          RadiusBottomRight: =10
                                          RadiusTopLeft: =10
                                          RadiusTopRight: =10
                                          Width: =Parent.Width - Self.X * 2
                                          X: =10
                                          Y: =100
                                        Children:
                                          - Label1_46:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                AlignInContainer: =AlignInContainer.Stretch
                                                BorderColor: =RGBA(0, 18, 107, 1)
                                                Color: =RGBA(45, 65, 93, 1)
                                                FillPortions: =1
                                                Font: =Font.Arial
                                                FontWeight: =FontWeight.Semibold
                                                LayoutMinHeight: =0
                                                LayoutMinWidth: =0
                                                Size: =14
                                                Text: |-
                                                  ="🏙️ EMPREENDIMENTO"
                                                Width: =100
                                          - ComboBox1_3:
                                              Control: Classic/ComboBox@2.4.0
                                              Properties:
                                                BorderColor: =RGBA(45, 65, 93, 1)
                                                BorderThickness: =3
                                                ChevronBackground: =RGBA(45, 65, 93, 1)
                                                ChevronFill: =RGBA(255, 255, 255, 1)
                                                ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                                DisplayFields: =["empreendimento"]
                                                Font: =Font.Arial
                                                Height: =38
                                                HoverFill: =RGBA(186, 202, 226, 1)
                                                Items: =ShowColumns(Filter(db_cont_empreendimento, n_contrato = ComboBox1_4.Selected.n_contrato),empreendimento, id_contrato_empreendimento)
                                                PressedColor: =RGBA(255, 255, 255, 1)
                                                PressedFill: =RGBA(0, 18, 107, 1)
                                                SearchFields: =["empreendimento"]
                                                SelectMultiple: =false
                                                SelectionColor: =RGBA(255, 255, 255, 1)
                                                SelectionFill: =RGBA(45, 65, 93, 1)
                                                Size: =12
                                                Width: =Parent.Width - 20
                                                X: =114
                                                Y: =203
                                    - Container5_17:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Fill: =RGBA(255, 255, 255, 1)
                                          Height: =80
                                          LayoutDirection: =LayoutDirection.Vertical
                                          PaddingBottom: =5
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          RadiusBottomLeft: =10
                                          RadiusBottomRight: =10
                                          RadiusTopLeft: =10
                                          RadiusTopRight: =10
                                          Width: =Parent.Width - Self.X * 2
                                          X: =10
                                          Y: =10
                                        Children:
                                          - Label1_47:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                AlignInContainer: =AlignInContainer.Stretch
                                                BorderColor: =RGBA(0, 18, 107, 1)
                                                Color: =RGBA(45, 65, 93, 1)
                                                FillPortions: =1
                                                Font: =Font.Arial
                                                FontWeight: =FontWeight.Semibold
                                                LayoutMinHeight: =0
                                                LayoutMinWidth: =0
                                                Size: =14
                                                Text: |-
                                                  ="📓 CONTRATO "
                                                Width: =100
                                          - ComboBox1_4:
                                              Control: Classic/ComboBox@2.4.0
                                              Properties:
                                                AlignInContainer: =AlignInContainer.Start
                                                BorderColor: =RGBA(45, 65, 93, 1)
                                                BorderThickness: =3
                                                ChevronBackground: =RGBA(45, 65, 93, 1)
                                                ChevronFill: =RGBA(255, 255, 255, 1)
                                                ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                                DisplayFields: =["objeto_reduzido"]
                                                Font: =Font.Arial
                                                Height: =38
                                                HoverFill: =RGBA(186, 202, 226, 1)
                                                Items: '=ShowColumns(db_cont_contrato, objeto_reduzido, n_contrato) '
                                                PressedColor: =RGBA(255, 255, 255, 1)
                                                PressedFill: =RGBA(0, 18, 107, 1)
                                                SearchFields: =["n_contrato"]
                                                SelectMultiple: =false
                                                SelectionColor: =RGBA(255, 255, 255, 1)
                                                SelectionFill: =RGBA(45, 65, 93, 1)
                                                Size: =12
                                                Width: |
                                                  =Parent.Width - 20
                                                X: =264
                                                Y: =185
                                    - Container5_18:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Fill: =RGBA(255, 255, 255, 1)
                                          Height: =80
                                          LayoutDirection: =LayoutDirection.Vertical
                                          PaddingBottom: =5
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          RadiusBottomLeft: =10
                                          RadiusBottomRight: =10
                                          RadiusTopLeft: =10
                                          RadiusTopRight: =10
                                          Width: =Parent.Width - Self.X * 2
                                          X: =10
                                          Y: =190
                                        Children:
                                          - Label1_48:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                AlignInContainer: =AlignInContainer.Stretch
                                                BorderColor: =RGBA(0, 18, 107, 1)
                                                Color: =RGBA(45, 65, 93, 1)
                                                FillPortions: =1
                                                Font: =Font.Arial
                                                FontWeight: =FontWeight.Semibold
                                                LayoutMinHeight: =0
                                                LayoutMinWidth: =0
                                                Size: =14
                                                Text: |-
                                                  ="🗓️ DATA DA FISCALIZAÇÃO"
                                                Width: =100
                                          - DatePicker1_1:
                                              Control: Classic/DatePicker@2.6.0
                                              Properties:
                                                BorderColor: =RGBA(45, 65, 93, 1)
                                                BorderThickness: =3
                                                Color: =RGBA(45, 65, 93, 1)
                                                DisabledBorderColor: =RGBA(45, 65, 93, 1)
                                                Font: =Font.Arial
                                                Height: =37
                                                IconBackground: =RGBA(45, 65, 93, 1)
                                                IconFill: =RGBA(255, 255, 255, 1)
                                                Size: =12
                                                Width: =Parent.Width - 20
                                                X: =10
                                                Y: =351
                                    - Container5_19:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Fill: =RGBA(255, 255, 255, 1)
                                          Height: =80
                                          LayoutDirection: =LayoutDirection.Vertical
                                          PaddingBottom: =5
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          RadiusBottomLeft: =10
                                          RadiusBottomRight: =10
                                          RadiusTopLeft: =10
                                          RadiusTopRight: =10
                                          Width: =Parent.Width - Self.X * 2
                                          X: =10
                                          Y: =280
                                        Children:
                                          - Label1_49:
                                              Control: Label@2.5.1
                                              Properties:
                                                Align: =Align.Center
                                                AlignInContainer: =AlignInContainer.Stretch
                                                BorderColor: =RGBA(0, 18, 107, 1)
                                                Color: =RGBA(45, 65, 93, 1)
                                                FillPortions: =1
                                                Font: =Font.Arial
                                                FontWeight: =FontWeight.Semibold
                                                LayoutMinHeight: =0
                                                LayoutMinWidth: =0
                                                Size: =14
                                                Text: |-
                                                  ="🔎 SELECIONE A FISCALIZAÇÃO"
                                                Width: =100
                                          - ComboBox1_5:
                                              Control: Classic/ComboBox@2.4.0
                                              Properties:
                                                BorderColor: =RGBA(45, 65, 93, 1)
                                                BorderThickness: =3
                                                ChevronBackground: =RGBA(45, 65, 93, 1)
                                                ChevronFill: =RGBA(255, 255, 255, 1)
                                                ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                ChevronHoverFill: =RGBA(255, 255, 255, 1)
                                                DisplayFields: =["tipo_pesquisa"]
                                                Font: =Font.Arial
                                                Height: =38
                                                HoverFill: =RGBA(186, 202, 226, 1)
                                                Items: '=ShowColumns(db_acomp_tipo_pesquisa, tipo_pesquisa, id_tipo_pesquisa) '
                                                PressedColor: =RGBA(255, 255, 255, 1)
                                                PressedFill: =RGBA(0, 18, 107, 1)
                                                SearchFields: =["id_tipo_pesquisa"]
                                                SelectMultiple: =false
                                                SelectionColor: =RGBA(255, 255, 255, 1)
                                                SelectionFill: =RGBA(45, 65, 93, 1)
                                                Size: =12
                                                Width: =Parent.Width - 20
                                                X: =194
                                                Y: =377
                                    - Container18_1:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Fill: =RGBA(255, 255, 255, 1)
                                          Height: =80
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutGap: =30
                                          LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          RadiusBottomLeft: =10
                                          RadiusBottomRight: =10
                                          RadiusTopLeft: =10
                                          RadiusTopRight: =10
                                          Width: =Parent.Width - Self.X * 2
                                          X: =10
                                          Y: =400
                                        Children:
                                          - Button1_4:
                                              Control: Classic/Button@2.2.0
                                              Properties:
                                                BorderColor: =ColorFade(Self.Fill, -15%)
                                                Color: =RGBA(255, 255, 255, 1)
                                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                                Fill: =RGBA(45, 65, 93, 1)
                                                FillPortions: =1
                                                Font: =Font.Arial
                                                Height: =35
                                                HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                                HoverColor: =RGBA(255, 255, 255, 1)
                                                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                LayoutMinWidth: =0
                                                OnSelect: =Set(varPopupNovaFiscalização, false)
                                                PressedBorderColor: =Self.Fill
                                                PressedColor: =Self.Fill
                                                PressedFill: =Self.Color
                                                Size: =12
                                                Text: ="CANCELAR"
                                                X: =10
                                                Y: =433
                                          - Button1_5:
                                              Control: Classic/Button@2.2.0
                                              Properties:
                                                BorderColor: =ColorFade(Self.Fill, -15%)
                                                Color: =RGBA(255, 255, 255, 1)
                                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                                Fill: =RGBA(45, 65, 93, 1)
                                                FillPortions: =1
                                                Font: =Font.Arial
                                                Height: =35
                                                HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                                                HoverColor: =RGBA(255, 255, 255, 1)
                                                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                                                LayoutMinWidth: =0
                                                OnSelect: |
                                                  =Navigate('Nova Fiscalização Screen');

                                                  Set(varPesquisaIniciar,true);

                                                  ClearCollect(
                                                      colDadosParaPatch,
                                                      AddColumns(
                                                          Filter(
                                                              db_acomp_perguntas_pesquisas,
                                                              id_tipo_pesquisa = ComboBox1_5.Selected.id_tipo_pesquisa
                                                          ),
                                                          id_contrato, ComboBox1_4.Selected.n_contrato,    
                                                          id_empreendimento, ComboBox1_3.Selected.id_contrato_empreendimento,
                                                          data_fiscalizacao, DatePicker1_1.SelectedDate,
                                                          id_fiscalizacao, Concatenate(ComboBox1_3.Selected.id_contrato_empreendimento, "-", ComboBox1_5.Selected.id_tipo_pesquisa, "-", DatePicker1_1.SelectedDate)
                                                      )
                                                  );

                                                  Patch(
                                                      db_acomp_empreendimento_fiscalizacao,
                                                      Defaults(db_acomp_empreendimento_fiscalizacao), 
                                                      {
                                                          id_contrato: ComboBox1_4.Selected.n_contrato, 
                                                          id_empreendimento: ComboBox1_3.Selected.id_contrato_empreendimento,
                                                          data_fiscalizacao: DatePicker1_1.SelectedDate,
                                                          id_tipo_pesquisa: ComboBox1_5.Selected.id_tipo_pesquisa,
                                                          id_fiscalizacao: Concatenate(ComboBox1_3.Selected.id_contrato_empreendimento, "-", ComboBox1_5.Selected.id_tipo_pesquisa, "-", DatePicker1_1.SelectedDate),
                                                          latitude: Location.Latitude,
                                                          longitude: Location.Longitude
                                                      }
                                                  );

                                                  ForAll(
                                                      colDadosParaPatch, 
                                                      Patch(
                                                          db_acomp_fiscalizacoes, 
                                                          Defaults(db_acomp_fiscalizacoes), 
                                                          {
                                                              id_contrato: ThisRecord.id_contrato,
                                                              id_empreendimento: ThisRecord.id_empreendimento,
                                                              id_tipo_pesquisa: ThisRecord.id_tipo_pesquisa,
                                                              id_pergunta_pesquisa: ThisRecord.id_pergunta_pesquisa,
                                                              data_fiscalizacao: ThisRecord.data_fiscalizacao,
                                                              id_fiscalizacao: ThisRecord.id_fiscalizacao
                                                          }
                                                      )
                                                  );

                                                  Set(var_Nova_Fiscalizacao, Concatenate(ComboBox1_3.Selected.id_contrato_empreendimento, "-", ComboBox1_5.Selected.id_tipo_pesquisa, "-", DatePicker1_1.SelectedDate));

                                                  Set(varPesquisaIniciar,false);
                                                PressedBorderColor: =Self.Fill
                                                PressedColor: =Self.Fill
                                                PressedFill: =Self.Color
                                                Size: =12
                                                Text: ="INICIAR PESQUISA"
                                                Width: =0
                                                X: =290
                                                Y: =433
                              - Container6_12:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    Height: =40
                                    RadiusBottomLeft: =10
                                    RadiusBottomRight: =10
                                    RadiusTopLeft: =10
                                    RadiusTopRight: =10
                                    Width: =Parent.Width - Self.X * 2
                                    X: =10
                                    Y: =20
                                  Children:
                                    - Label1_19:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 18, 107, 1)
                                          Color: =RGBA(255, 255, 255, 1)
                                          Fill: =RGBA(45, 65, 93, 1)
                                          Font: =Font.Arial
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =16
                                          Text: ="NOVA FISCALIZAÇÃO"
                                          Width: =Parent.Width - Self.X
                                          Wrap: =false
