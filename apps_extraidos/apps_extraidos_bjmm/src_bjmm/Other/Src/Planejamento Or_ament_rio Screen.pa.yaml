# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Planejamento Or√ßament√°rio Screen:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |-
        =ClearCollect(
            colNomesMesesPlanejamento,
            {NomeDoMes: "1¬∫ M√äS"},
            {NomeDoMes: "2¬∫ M√äS"},
            {NomeDoMes: "3¬∫ M√äS"},
            {NomeDoMes: "4¬∫ M√äS"},
            {NomeDoMes: "5¬∫ M√äS"},
            {NomeDoMes: "6¬∫ M√äS"},
            {NomeDoMes: "7¬∫ M√äS"},
            {NomeDoMes: "8¬∫ M√äS"},
            {NomeDoMes: "9¬∫ M√äS"},
            {NomeDoMes: "10¬∫ M√äS"},
            {NomeDoMes: "11¬∫ M√äS"},
            {NomeDoMes: "12¬∫ M√äS"},
            {NomeDoMes: "13¬∫ M√äS"},
            {NomeDoMes: "14¬∫ M√äS"},
            {NomeDoMes: "15¬∫ M√äS"},
            {NomeDoMes: "16¬∫ M√äS"},
            {NomeDoMes: "17¬∫ M√äS"},
            {NomeDoMes: "18¬∫ M√äS"},
            {NomeDoMes: "P√ìS OBRA"}
        )
    Children:
      - app_cpn_bonin_13:
          Control: CanvasComponent
          ComponentName: app_cpn_bonin
          Properties:
            ButtonHeight: =50
            ButtonHeightSUB: =40
            ButtonRadius: =0
            Fill: =RGBA(255, 255, 255, 1)
            Height: =918
            HoverFill: ="#EBEAEA33"
            ListaDasTelas: =colTelas
            ListaIcones: =ColLogo
            OnSelect: =
            Width: =1920
      - Label1_133:
          Control: Label@2.5.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Arial
            FontWeight: =FontWeight.Semibold
            Height: =100
            Size: =18
            Text: ="SISTEMA INTEGRADO DE GEST√ÉO E DESENVOLVIMENTO BJMM - PLANEJAMENTO OR√áAMENT√ÅRIO"
            Width: =Parent.Width - Self.X - 10
            Wrap: =false
            X: =230
      - Container1_11:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            BorderStyle: =BorderStyle.None
            DropShadow: =DropShadow.None
            Height: =Parent.Height - Self.Y
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: '=Parent.Width - Self.X - 10 '
            X: =230
            Y: =110
          Children:
            - Container2_8:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Height: =Parent.Height
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =10
                  PaddingBottom: =10
                  PaddingLeft: =10
                  PaddingRight: =10
                  PaddingTop: =10
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Parent.Width
                Children:
                  - Container3_6:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(45, 65, 93, 1)
                        FillPortions: =0
                        Height: =70
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingTop: =5
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                      Children:
                        - Container5_16:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: |
                                =0
                              PaddingBottom: =5
                              PaddingLeft: =5
                              PaddingRight: =5
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =200
                            Children:
                              - Label1_141:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Justify
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Semibold
                                    LayoutMinHeight: =0
                                    Size: =10
                                    Text: |-
                                      ="üîé CONTRATO "
                                    Width: =100
                              - TextInput1_16:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(45, 65, 93, 1)
                                    Default: =
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =10
                                    Width: =0
                        - Container5_17:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: |
                                =0
                              PaddingBottom: =5
                              PaddingLeft: =5
                              PaddingRight: =5
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =250
                              X: =40
                              Y: =40
                            Children:
                              - Label1_142:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Justify
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Semibold
                                    LayoutMinHeight: =0
                                    Size: =10
                                    Text: |-
                                      ="üîé OBJETO REDUZIDO "
                                    Width: =100
                              - TextInput1_17:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(45, 65, 93, 1)
                                    Default: =
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =10
                                    Width: =0
                        - Container5_18:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutMinHeight: |
                                =0
                              PaddingBottom: =5
                              PaddingLeft: =5
                              PaddingRight: =5
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =250
                              X: =40
                              Y: =40
                            Children:
                              - Label1_143:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Justify
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Semibold
                                    LayoutMinHeight: =0
                                    Size: =10
                                    Text: |-
                                      ="üîé CONTRATADA "
                                    Width: =100
                              - TextInput1_18:
                                  Control: Classic/TextInput@2.3.2
                                  Properties:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    BorderColor: =RGBA(45, 65, 93, 1)
                                    Default: =
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    HoverBorderColor: =RGBA(0, 18, 107, 1)
                                    HoverFill: =RGBA(186, 202, 226, 1)
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =10
                                    Width: =0
                  - Container4_7:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderStyle: =BorderStyle.None
                        DropShadow: =DropShadow.None
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                      Children:
                        - Container8_14:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(45, 65, 93, 1)
                              Height: =Parent.Height
                              LayoutDirection: =LayoutDirection.Vertical
                              PaddingBottom: =5
                              PaddingLeft: =5
                              PaddingRight: =5
                              PaddingTop: =5
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.Width
                            Children:
                              - Gallery3_5:
                                  Control: Gallery@2.15.0
                                  Variant: VariableHeight
                                  Properties:
                                    BorderColor: =
                                    Height: =Parent.Height
                                    Items: |-
                                      =Filter(
                                          db_cont_contrato,
                                          IsBlank(TextInput1_16.Text) || StartsWith(n_contrato, TextInput1_16.Text),
                                          IsBlank(TextInput1_17.Text) || StartsWith(objeto_reduzido, TextInput1_17.Text),
                                          IsBlank(TextInput1_18.Text) || StartsWith(contratada, TextInput1_18.Text))
                                    LayoutMinHeight: =0
                                    ShowScrollbar: =false
                                    TemplateSize: =60
                                    Width: =Parent.Width
                                  Children:
                                    - Gallery1_2:
                                        Control: Gallery@2.15.0
                                        Variant: VariableHeight
                                        Properties:
                                          BorderColor: =RGBA(0, 18, 107, 1)
                                          Height: |-
                                            =If(varQuantidadeItensDetalhado = 0,
                                            Self.AllItemsCount * 30 * 2 + (35 * varQuantidadeItensDetalhado),
                                            Self.AllItemsCount * 35 * 2 + (3.37 * varQuantidadeItensDetalhado + 20))
                                          Items: =Filter(db_cont_empreendimento, n_contrato = ThisItem.n_contrato)
                                          ShowScrollbar: =false
                                          TemplatePadding: =0
                                          TemplateSize: =50
                                          Visible: =varExpandido = ThisItem.ID
                                          Width: =Parent.TemplateWidth-Self.X
                                          X: =1
                                          Y: =60
                                        Children:
                                          - Container7_21:
                                              Control: GroupContainer@1.3.0
                                              Variant: ManualLayout
                                              Properties:
                                                DropShadow: =DropShadow.Semilight
                                                Fill: =RGBA(255, 255, 255, 1)
                                                Height: =htmltxt_historico_2.Height + If(htmltxt_historico_viajantes_2.Visible, htmltxt_historico_viajantes_2.Height, 0)
                                                RadiusBottomLeft: =10
                                                RadiusBottomRight: =10
                                                RadiusTopLeft: =10
                                                RadiusTopRight: =10
                                                Width: =Parent.Width
                                              Children:
                                                - htmltxt_historico_viajantes_2:
                                                    Control: HtmlViewer@2.1.0
                                                    Properties:
                                                      AutoHeight: =true
                                                      Color: =RGBA(0, 0, 0, 0)
                                                      Fill: =RGBA(214, 223, 238, 1)
                                                      Font: =Font.'Open Sans'
                                                      Height: =103
                                                      HtmlText: "=\"<div style='\" &\r\n    \"width:100%; \" &\r\n    \"overflow-x: auto;\" & // Mant√©m a barra de rolagem horizontal\r\n    \"font-family:Segoe UI; \" &\r\n    \"font-size:11px; \" &\r\n    \"color:white; \" &\r\n    \"background-color: #2b3b55; \" &\r\n    \"padding: 15px; \" &\r\n    \"border-radius: 8px; \" &\r\n    \"box-shadow: 2px 2px 5px rgba(0,0,0,0.3);\" &\r\n\"'>\" &\r\n\r\n    \"<h2 style='font-size:18px; font-weight:bold; margin-bottom:15px; color:white; text-align: left;'>\" &\r\n        \"PLANEJAMENTO OR√áAMENT√ÅRIO\" &\r\n    \"</h2>\" &\r\n\r\n    \"<table style='\" &\r\n        \"width:1px; \" & // Use '1px' para for√ßar o layout fixo\r\n        \"table-layout: fixed; \" & // ESSENCIAL para fixar larguras\r\n        \"min-width: 2560px; \" & // Ajuste este valor. Ex: 80(item) + 250(desc) + 200(valor total) + 18*120(meses) = 530 + 2160 = 2690px.\r\n                                // Coloquei 2560px, voc√™ pode ajustar para caber o texto.\r\n        \"border-collapse: collapse; \" &\r\n        \"border: 1px solid #4a6184; \" &\r\n    \"'>\" &\r\n        \"<thead>\" &\r\n            \"<tr style='height: 25px; background-color: #3b5073; color: white;'>\" &\r\n                // Larguras fixas para as colunas do cabe√ßalho\r\n                \"<th style='width:80px; padding: 8px; text-align: left; border: 1px solid #4a6184;'>ITEM</th>\" &\r\n                \"<th style='width:250px; padding: 8px; text-align: left; border: 1px solid #4a6184; word-wrap: break-word;'>DESCRI√á√ÉO DOS SERVI√áOS</th>\" &\r\n                \"<th style='width:200px; padding: 8px; text-align: center; border: 1px solid #4a6184;'>VALOR TOTAL</th>\" &\r\n                \r\n                Concat(colNomesMesesPlanejamento As MesHeader, // Alias para o cabe√ßalho dos meses\r\n                \"<th style='width:120px; padding: 8px; text-align: center; border: 1px solid #4a6184;'>\" & MesHeader.NomeDoMes & \"</th>\" // <--- LARGURA DO M√äS NO CABE√áALHO (120px)\r\n                ) &\r\n            \"</tr>\" &\r\n        \"</thead>\" &\r\n\r\n        \"<tbody>\" &\r\n            Concat( // CONCAT PRINCIPAL PARA GRUPOS\r\n                GroupBy(\r\n                    SortByColumns(\r\n                        colPlanejamentoEmpreendimento,\r\n                        \"item_grupo\", SortOrder.Ascending,\r\n                        \"nivel_1\", SortOrder.Ascending\r\n                    ),\r\n                    item_grupo,\r\n                    DadosDoGrupo\r\n                ) As Grupo,\r\n                \r\n                With({\r\n                    TotalGrupoValor: Sum(Grupo.DadosDoGrupo, Coalesce(valor_bdi, 0)) // Usando valor_bdi\r\n                },\r\n                // Linha de T√≠tulo do Grupo\r\n                \"<tr>\" &\r\n                    \"<td colspan='2' style='padding: 8px; text-align: left; background-color: #4a6184; color: white; font-weight: bold; border: 1px solid #6c88b7;'>\" &\r\n                        Coalesce(Grupo.item_grupo, \"\") &\r\n                    \"</td>\" &\r\n                    \"<td style='width:200px; padding: 8px; text-align: right; background-color: #4a6184; color: white; font-weight: bold; border: 1px solid #6c88b7;'>\" &\r\n                        Text(TotalGrupoValor, \"[$-pt-BR]R$ #.##0,00\") &\r\n                    \"</td>\" &\r\n                    Concat(colNomesMesesPlanejamento As MesCalcGrupo, // Alias para calculo de meses do grupo\r\n                        With({\r\n                            TotalMesGrupo: Sum(Filter(Grupo.DadosDoGrupo, num_mes = MesCalcGrupo.NomeDoMes), Coalesce(valor_bdi, 0)) // Usando valor_bdi\r\n                        },\r\n                        \"<td style='width:120px; padding: 8px; text-align: center; background-color: #4a6184; color: white; font-weight: bold; border: 1px solid #6c88b7;'>\" & // <--- LARGURA DO M√äS NO TD DE GRUPO (120px)\r\n                            If(TotalMesGrupo > 0, Text(TotalMesGrupo, \"[$-pt-BR]R$ #.##0,00\"), \"-\") &\r\n                        \"</td>\"\r\n                        )\r\n                    ) &\r\n                \"</tr>\" &\r\n\r\n                // Gera√ß√£o das Linhas de Detalhe dentro de cada Grupo\r\n                Concat(\r\n                    GroupBy(\r\n                        Sort(Grupo.DadosDoGrupo, nivel_1, SortOrder.Ascending),\r\n                        nivel_1,\r\n                        DadosDoItem\r\n                    ) As ItemDetalhe,\r\n                    \r\n                    With({\r\n                        DescricaoItem: Coalesce(First(ItemDetalhe.DadosDoItem).descricao, \"\"),\r\n                        TotalItemAnual: Sum(Filter(colPlanejamentoEmpreendimento, \r\n                                            item_grupo = Grupo.item_grupo && \r\n                                            nivel_1 = ItemDetalhe.nivel_1), \r\n                                            Coalesce(valor_bdi, 0)) // Usando valor_bdi\r\n                    },\r\n                    \"<tr>\" &\r\n                        \"<td style='width:80px; padding: 8px; text-align: left; background-color: #3b5073; color: white; border: 1px solid #4a6184;'>\" & Coalesce(ItemDetalhe.nivel_1, \"\") & \"</td>\" & \r\n                        \"<td style='width:250px; padding: 8px; text-align: left; background-color: #3b5073; color: white; border: 1px solid #4a6184; word-wrap: break-word;'>\" & DescricaoItem & \"</td>\" & \r\n                        \"<td style='width:200px; padding: 8px; text-align: right; background-color: #3b5073; color: white; border: 1px solid #4a6184;'>\" & Text(TotalItemAnual, \"[$-pt-BR]R$ #.##0,00\") & \"</td>\" & \r\n                        \r\n                        Concat(colNomesMesesPlanejamento As MesDetalhe,\r\n                            With({\r\n                                DadosDoMes: LookUp(\r\n                                    ItemDetalhe.DadosDoItem,\r\n                                    num_mes = MesDetalhe.NomeDoMes\r\n                                )\r\n                            },\r\n                            \"<td style='width:120px; padding: 2px; text-align: center; vertical-align: top; border: 1px solid #4a6184;'>\" & // <--- LARGURA DO M√äS NO TD DE DETALHE (120px)\r\n                                If(\r\n                                    !IsBlank(DadosDoMes) && Coalesce(DadosDoMes.percentual_previsto, 0) > 0,\r\n                                    \"<div style='background-color: #5d81b9; color: white; padding: 5px; border-radius: 4px; font-size:9px; margin: 3px; box-shadow: 1px 1px 2px rgba(0,0,0,0.2);'>\" &\r\n                                        Text(Coalesce(DadosDoMes.percentual_previsto, 0) * 100, \"[$-pt-BR] #.##0,00%\") &\r\n                                        \"<div style='font-size:9px; opacity:0.8;'>\" & Text(Coalesce(DadosDoMes.valor_bdi, 0), \"[$-pt-BR]R$ #.##0,00\") & \"</div>\" & \r\n                                    \"</div>\",\r\n                                    \"-\"\r\n                                ) &\r\n                            \"</td>\"\r\n                            )\r\n                        ) &\r\n                    \"</tr>\"\r\n                    )\r\n                ) &\r\n                \"<tr><td colspan='\" & (3 + CountRows(colNomesMesesPlanejamento)) & \"' style='height:15px; background-color: #2b3b55;'></td></tr>\"\r\n                )\r\n            ) &\r\n\r\n            // Linha de TOTAL GERAL\r\n            With({\r\n                TotalGeralValor: Sum(colPlanejamentoEmpreendimento, Coalesce(valor_bdi, 0)) // Usando valor_bdi\r\n            },\r\n            \"<tr style='height: 45px; background-color: #5d81b9; color: white; font-weight: bold;'>\" &\r\n                \"<td colspan='2' style='padding: 8px; text-align: right; border: 1px solid #6c88b7;'>TOTAL GERAL:</td>\" &\r\n                \"<td style='width:200px; padding: 8px; text-align: right; border: 1px solid #6c88b7;'>\" & Text(TotalGeralValor, \"[$-pt-BR]R$ #.##0,00\") & \"</td>\" & \r\n                \r\n                Concat(colNomesMesesPlanejamento As MesTotalGeral,\r\n                    With({\r\n                        TotalMesGeral: Sum(Filter(colPlanejamentoEmpreendimento, num_mes = MesTotalGeral.NomeDoMes), Coalesce(valor_bdi, 0)) // Usando valor_bdi\r\n                    },\r\n                    // <--- AQUI EST√Å A CORRE√á√ÉO PRINCIPAL: APENAS O CONTE√öDO DA C√âLULA E NADA MAIS.\r\n                    \"<td style='width:120px; padding: 8px; text-align: center; border: 1px solid #6c88b7;'>\" & // <--- LARGURA DO M√äS NO TD DE TOTAL GERAL (120px)\r\n                        If(TotalMesGeral > 0, Text(TotalMesGeral, \"[$-pt-BR]R$ #.##0,00\"), \"-\") &\r\n                    \"</td>\"\r\n                    )\r\n                ) &\r\n            \"</tr>\"\r\n            ) &\r\n        \"</tbody>\" &\r\n    \"</table>\" &\r\n\"</div>\""
                                                      OnSelect: =
                                                      Visible: =varHistoricoExpandido = ThisItem.id_contrato_empreendimento
                                                      Width: =Parent.Width
                                                      Y: =htmltxt_historico_2.Y + htmltxt_historico_2.Height
                                                - htmltxt_historico_2:
                                                    Control: HtmlViewer@2.1.0
                                                    Properties:
                                                      BorderColor: =RGBA(0, 0, 0, 0)
                                                      Fill: =RGBA(214, 223, 238, 1)
                                                      Font: =Font.'Open Sans'
                                                      Height: =60
                                                      HtmlText: |-
                                                        ="<div style='width:100%; height:auto; font-family:Segoe UI; font-size:12px; color:#2d415d; padding:10px;'>

                                                          <!-- Nome -->
                                                          <div style='font-size:14px; font-weight:bold; margin-bottom:2px;'>
                                                            " & Concatenate(LookUp(db_cont_empreendimento, n_contrato = ThisItem.n_contrato, id_contrato_empreendimento), " - ", LookUp(db_cont_empreendimento, n_contrato = ThisItem.n_contrato, empreendimento)) & "
                                                          </div>

                                                        <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                                          <div style='display:flex; gap:20px; flex-wrap:wrap; margin-bottom:2px; line-height:1.2em;'>
                                                            <div style='flex:1'><strong>SEI:</strong> " & ThisItem.construtora & "</div>
                                                            <div style='flex:1'><strong>Data Assinatura:</strong> " & ThisItem.empreendimento & "</div>
                                                            <div style='flex:1'><strong>Valor Contrato:</strong> " & Text(ThisItem.n_unidade_habitacional, "[$-pt-BR]R$ #.##0,00") & "</div>
                                                          </div>
                                                        </div>"
                                                      PaddingBottom: =0
                                                      PaddingLeft: =0
                                                      PaddingRight: =0
                                                      PaddingTop: =0
                                                      Width: =Parent.Width
                                                - icn_expandir_5:
                                                    Control: Classic/Icon@2.5.0
                                                    Properties:
                                                      Color: =Color.White
                                                      Height: =30
                                                      Icon: =Icon.Settings
                                                      OnSelect: =Set(varVisualizarEdicaoOrcamento, true);
                                                      Visible: =varHistoricoExpandido = ThisItem.id_contrato_empreendimento
                                                      Width: =40
                                                      X: =Parent.Width - Self.Width - 10
                                                      Y: =75
                                                - icn_expandir_2:
                                                    Control: Classic/Icon@2.5.0
                                                    Properties:
                                                      Height: =htmltxt_historico_2.Height - Self.Y * 2
                                                      Icon: |
                                                        =If(varHistoricoExpandido = ThisItem.id_contrato_empreendimento, Icon.ChevronUp, Icon.ChevronDown)
                                                      OnSelect: |
                                                        =UpdateContext({
                                                            varHistoricoExpandido: If(varHistoricoExpandido = ThisItem.id_contrato_empreendimento, Blank(), ThisItem.id_contrato_empreendimento)
                                                        });

                                                        ClearCollect(colPlanejamentoEmpreendimento, Filter(db_fin_planejamento, id_contrato_empreendimento = ThisItem.id_contrato_empreendimento));


                                                        If(Self.Icon = Icon.ChevronDown, 
                                                            Set(varQuantidadeItensDetalhado, 0), 
                                                                Set(varQuantidadeItensDetalhado, 
                                                                    If(CountRows(colPlanejamentoEmpreendimento) = 0, 50, CountRows(colPlanejamentoEmpreendimento))));
                                                      Width: =40
                                                      X: =Parent.Width - Self.Width - 10
                                                      Y: =15
                                    - Container34_5:
                                        Control: GroupContainer@1.3.0
                                        Variant: ManualLayout
                                        Properties:
                                          DropShadow: =DropShadow.Semilight
                                          Height: =Parent.TemplateHeight
                                          PaddingLeft: =20
                                          PaddingRight: =20
                                          RadiusBottomLeft: =10
                                          RadiusBottomRight: =10
                                          RadiusTopLeft: =10
                                          RadiusTopRight: =10
                                          Width: =Parent.Width - 10
                                        Children:
                                          - HtmlText1_4:
                                              Control: HtmlViewer@2.1.0
                                              Properties:
                                                Fill: =RGBA(255, 255, 255, 1)
                                                Font: =Font.'Open Sans'
                                                Height: =Parent.Height
                                                HtmlText: |-
                                                  ="<div style='width:100%; font-family:Segoe UI; font-size:12px; color:#2d415d; padding:5px; border-bottom:1px solid white;'>
                                                   <!-- Nome -->
                                                   <div style='font-size:14px; font-weight:bold; margin-bottom:2px;'>
                                                    " & Concatenate(ThisItem.n_contrato, " - ", ThisItem.objeto_reduzido) & "
                                                   </div>

                                                  <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                                   <div style='display:flex; gap:20px; flex-wrap:wrap; margin-bottom:2px; line-height:1.2em;'>

                                                    <div style='flex:1'><strong>SEI:</strong> " & ThisItem.processo_sei & "</div>

                                                    <div style='flex:1'><strong>Data Assinatura:</strong> " & ThisItem.data_ass_contrato & "</div>

                                                    <div style='flex:1'><strong>Data T√©rmino Prevista:</strong> " &

                                                      DateAdd(ThisItem.data_ass_contrato, Sum(Filter(db_cont_econtratual, n_contrato = ThisItem.n_contrato), prazo_ec_dia), TimeUnit.Days)

                                                    & "</div>

                                                    <div style='flex:1'><strong>Valor Contrato:</strong> " & Text(ThisItem.valor_contrato_inicial, "[$-pt-BR]R$ #.##0,00") & "</div>

                                                   </div>

                                                  </div>"
                                                Width: =Parent.Width
                                          - icoSeta_5:
                                              Control: Classic/Icon@2.5.0
                                              Properties:
                                                BorderColor: =RGBA(0, 0, 0, 1)
                                                DisabledBorderColor: =
                                                DisabledColor: =RGBA(202, 202, 202, 1)
                                                DisabledFill: =RGBA(0, 0, 0, 0)
                                                DisplayMode: =If(!IsEmpty(Filter(db_cont_empreendimento, n_contrato = ThisItem.n_contrato)), DisplayMode.Edit, DisplayMode.Disabled)
                                                FocusedBorderThickness: =0
                                                Height: =Parent.Height
                                                HoverColor: =ColorFade(Self.Color, 10%)
                                                HoverFill: =
                                                Icon: |
                                                  =If(varExpandido = ThisItem.ID, Icon.ChevronDown, Icon.ChevronRight)
                                                OnSelect: |-
                                                  =UpdateContext({varExpandido: If(varExpandido = ThisItem.ID, Blank(), ThisItem.ID)});
                                                  Set(varQuantidadeItensDetalhado, 0);
                                                  UpdateContext({varHistoricoExpandido: Blank()});

                                                  If(Self.Icon = Icon.ChevronRight, 
                                                      Set(varBordaOrcamento, true), Set(varBordaOrcamento, false))
                                                PaddingBottom: =10
                                                PaddingRight: =Self.Width-Self.Height
                                                PaddingTop: =10
                                                Width: |
                                                  =60
                                                X: '=Parent.Width - Self.Width '
