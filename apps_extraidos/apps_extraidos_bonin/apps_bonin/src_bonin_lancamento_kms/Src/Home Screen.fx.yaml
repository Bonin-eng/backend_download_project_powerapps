"'Home Screen' As screen":
    OnVisible: |-
        =ClearCollect(colLancamento, Filter(sigd_frota_lancamentos, id_referencia_condutor = varUsuario.ID_Referencia));
        
        ClearCollect(
            colMesAno,
            Distinct(
                AddColumns(
                    colLancamento,
                    MesRef,
                    Text(data_viagem, "[$-pt-BR]mmm/yyyy")   // Formata Mês/Ano
                ),
                MesRef
            )
        );

    cpm_Tela_Geral_1 As cpm_Tela_Geral:

    Container7 As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height - 60
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width - Self.X * 2
        X: =10
        ZIndex: =4

        Container6_2 As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =60
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            maximumHeight: =11360
            maximumWidth: =640
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            ZIndex: =1

            Label1_12 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Font: =Font.Arial
                FontWeight: =FontWeight.Semibold
                Height: =60
                Size: =16
                Text: ="TELA INICIAL"
                Width: =Parent.Width - Self.X
                Wrap: =false
                ZIndex: =1

        Container6_3 As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =125
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            maximumHeight: =11360
            maximumWidth: =640
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            ZIndex: =2

            Container7_1 As groupContainer.manualLayoutContainer:
                DropShadow: =DropShadow.Semilight
                Fill: =RGBA(45, 65, 93, 1)
                Height: =110
                maximumHeight: =11360
                maximumWidth: =640
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Width: =Parent.Width - Self.X * 2
                Y: =10
                ZIndex: =1

                img_colab As image:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderThickness: =2
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Fill: =RGBA(45, 65, 93, 1)
                    Height: =70
                    HoverBorderColor: =
                    HoverFill: =
                    Image: =UsuáriosdoOffice365.UserPhoto(User().Email)
                    ImagePosition: =ImagePosition.Fill
                    PressedBorderColor: =
                    PressedFill: =
                    RadiusBottomLeft: =90
                    RadiusBottomRight: =90
                    RadiusTopLeft: =90
                    RadiusTopRight: =90
                    TabIndex: =-2
                    Width: =70
                    X: =20
                    Y: =20
                    ZIndex: =1

                Label9_1 As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =RGBA(255, 255, 255, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    Height: =70
                    Size: =14
                    Text: =Upper(User().FullName)
                    Width: =286
                    X: =100
                    Y: =20
                    ZIndex: =2

                Image5 As image:
                    AutoDisableOnSelect: =false
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisplayMode: =DisplayMode.View
                    Fill: =RGBA(45, 65, 93, 1)
                    Height: =90
                    HoverBorderColor: =
                    HoverFill: =
                    Image: ='logo-bonin-light 1'
                    PressedBorderColor: =
                    PressedFill: =
                    Width: =228
                    X: =386
                    Y: =10
                    ZIndex: =3

        Container6_4 As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.None
            Height: =60
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            maximumHeight: =11360
            maximumWidth: =640
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            ZIndex: =3

            Container9 As groupContainer.manualLayoutContainer:
                BorderColor: =RGBA(45, 65, 93, 1)
                BorderThickness: =2
                DropShadow: =DropShadow.Semilight
                Fill: =RGBA(45, 65, 93, 1)
                Height: =Parent.Height - Self.Y * 2
                maximumHeight: =11360
                maximumWidth: =640
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Width: =Parent.Width - Self.X * 2
                Y: =10
                ZIndex: =1

                Gallery3_3 As gallery.variableTemplateHeightGallery:
                    '#CopilotOverlayLabel': ="Filtrada"
                    BorderColor: =
                    DelayItemLoading: =true
                    Height: =Parent.Height - Self.Y
                    Items: |-
                        =SortByColumns(
                            Filter(
                                colLancamento,
                                IsBlank(TextInput1_17.Selected.Value) || Text(data_viagem, "[$-pt-BR]mmm/yyyy") = TextInput1_17.Selected.Value),
                            "data_viagem",
                            SortOrder.Ascending)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    ShowScrollbar: =false
                    TemplateSize: =120
                    Width: =Parent.Width
                    Y: =160
                    ZIndex: =1

                    Container34_3 As groupContainer.manualLayoutContainer:
                        DropShadow: =DropShadow.Semilight
                        Height: =Parent.TemplateHeight
                        maximumHeight: =11360
                        maximumWidth: =640
                        PaddingLeft: =20
                        PaddingRight: =20
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width - 10
                        ZIndex: =1

                        HtmlText1_2 As htmlViewer:
                            Fill: =RGBA(255, 255, 255, 1)
                            Height: =Parent.Height
                            HtmlText: |
                                ="<div style='width:100%; font-family:Arial; font-size:15px; color:#2d415d; padding:5px; border-bottom:1px solid white;'>
                                
                                  <!-- Nome -->
                                  <div style='font-size:18px; font-weight:bold; margin-bottom:2px;'>
                                    " & Concatenate(ThisItem.data_viagem, " - ", ThisItem.motivo_viagem) & "
                                  </div>
                                
                                <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                  <div style='font-size:14px; display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; margin-bottom:2px'>
                                    <div style='width:600px'><strong>Contratada:</strong> " & ThisItem.local_saida & "</div>
                                  </div>
                                <!-- Linha 1: SEI, Contratada, CNPJ Contratada, Data Assinatura -->
                                  <div style='font-size:14px; display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; margin-bottom:2px'>
                                    <div style='width:170px'><strong>Status:</strong> " & ThisItem.local_chegada & "</div>
                                  </div>
                                </div>"
                            Size: =21
                            Width: =Parent.Width
                            ZIndex: =1

                        Button4_1 As button:
                            Color: =RGBA(0, 0, 0, 0)
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height
                            HoverBorderColor: =
                            HoverColor: =RGBA(0, 0, 0, 0)
                            HoverFill: =
                            OnSelect: |-
                                =Set(varEditarViagem, true);
                                Set(varViagemSelecionada, ThisItem);
                                Navigate('Lançamento KM Screen');
                            PressedBorderColor: =
                            PressedFill: =
                            Size: =24
                            Text: =
                            Width: =Parent.Width
                            ZIndex: =2

                Container10_4 As groupContainer.horizontalAutoLayoutContainer:
                    BorderColor: =RGBA(45, 65, 93, 1)
                    DropShadow: =DropShadow.None
                    Fill: =RGBA(45, 65, 93, 1)
                    Height: =50
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMode: =LayoutMode.Auto
                    maximumHeight: =11360
                    maximumWidth: =640
                    PaddingBottom: =2
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =2
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Width: =Parent.Width
                    Y: =10
                    ZIndex: =2

                    Button1_2 As button:
                        AlignInContainer: =AlignInContainer.Stretch
                        Color: =RGBA(45, 65, 93, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =1
                        Font: =Font.Arial
                        Height: =35
                        LayoutMinHeight: =0
                        LayoutMinWidth: =280
                        OnSelect: |-
                            =Set(varEditarViagem, false);
                            Navigate('Lançamento KM Screen')
                        Size: =12
                        Text: ="NOVO LANÇAMENTO"
                        Width: =280
                        X: =4
                        Y: =35
                        ZIndex: =2

                Container10_3 As groupContainer.horizontalAutoLayoutContainer:
                    BorderColor: =RGBA(45, 65, 93, 1)
                    DropShadow: =DropShadow.None
                    Fill: =RGBA(45, 65, 93, 1)
                    Height: =80
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMode: =LayoutMode.Auto
                    maximumHeight: =11360
                    maximumWidth: =640
                    PaddingLeft: =5
                    PaddingRight: =5
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Width: =Parent.Width
                    Y: =70
                    ZIndex: =3

                    Container5_11 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        maximumHeight: =11360
                        maximumWidth: =640
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =260
                        ZIndex: =1

                        Label1_41 As label:
                            Align: =Align.Center
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(45, 65, 93, 1)
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            Height: =70
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Text: ="📓 FILTRAR MÊS "
                            Width: =100
                            ZIndex: =1

                        TextInput1_17 As combobox:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(45, 65, 93, 1)
                            ChevronBackground: =RGBA(45, 65, 93, 1)
                            ChevronDisabledBackground: =RGBA(255, 255, 255, 1)
                            Color: =RGBA(255, 255, 255, 1)
                            DisabledBorderColor: =RGBA(255, 255, 255, 1)
                            DisabledColor: =RGBA(255, 255, 255, 1)
                            DisplayFields: =["Value"]
                            Fill: =RGBA(45, 65, 93, 1)
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            HoverColor: =RGBA(255, 255, 255, 1)
                            HoverFill: =RGBA(45, 65, 93, 1)
                            InputTextPlaceholder: =
                            Items: =colMesAno
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnChange: =
                            OnSelect: =
                            PaddingBottom: =10
                            PaddingLeft: =10
                            PaddingRight: =10
                            PaddingTop: =10
                            SearchFields: =["Value"]
                            SearchItems: =Search(colMesAno,TextInput1_17.SearchText,Value)
                            SelectionFill: =RGBA(45, 65, 93, 1)
                            SelectMultiple: =false
                            Size: =12
                            Width: =Parent.Width
                            ZIndex: =2

